# DiagMod - –°–∏—Å—Ç–µ–º–∞ —Ç–æ–∫–æ–≤–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –¥–≤–∏–≥–∞—Ç–µ–ª–µ–π

## –û–ø–∏—Å–∞–Ω–∏–µ

DiagMod - —ç—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –¥–≤–∏–≥–∞—Ç–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ —Ç–æ–∫–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–æ–≤ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –°–∏—Å—Ç–µ–º–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π, –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–≤–∏–≥–∞—Ç–µ–ª–µ–π –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- üìä **–ê–Ω–∞–ª–∏–∑ —Ç–æ–∫–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤**: –û–±—Ä–∞–±–æ—Ç–∫–∞ CSV –¥–∞–Ω–Ω—ã—Ö —Å —Ç–æ–∫–∞–º–∏ —Ç—Ä–µ—Ö —Ñ–∞–∑ (R, S, T)
- ü§ñ **–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ**: –ú–æ–¥–µ–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π –∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è
- üîç **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**: FFT, RMS, kurtosis, skewness –∏ –¥—Ä—É–≥–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏
- üåê **Web API**: RESTful API –Ω–∞ FastAPI –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- üì± **Dashboard**: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ Streamlit
- ‚ö° **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: Celery –¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á
- üìà **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: Prometheus + Grafana –¥–ª—è –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç–∏
- üê≥ **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è**: Docker –¥–ª—è –ª–µ–≥–∫–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
- üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
CSV Files ‚Üí Data Processing ‚Üí PostgreSQL ‚Üí Feature Extraction ‚Üí ML Models
                ‚Üì               ‚Üì             ‚Üì                 ‚Üì
           Worker Tasks ‚Üí Redis Cache ‚Üí API Routes ‚Üí Dashboard ‚Üí Monitoring
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

```bash
git clone <repository-url>
cd DiagMod
make setup  # –°–æ–∑–¥–∞–Ω–∏–µ .env –∏ –ø–∞–ø–æ–∫
```

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `.env` —Å–æ–≥–ª–∞—Å–Ω–æ –≤–∞—à–µ–º—É –æ–∫—Ä—É–∂–µ–Ω–∏—é:

```bash
cp .env.example .env
# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, Redis, API –∏ —Ç.–¥.
```

### 3. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

```bash
make build  # –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤
make up     # –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
make migrate # –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –ë–î
make seed   # –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```

### 4. –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º

- **API**: http://localhost:8000
- **Dashboard**: http://localhost:8501  
- **API Docs**: http://localhost:8000/docs
- **Prometheus**: http://localhost:9090
- **Grafana**: http://localhost:3000 (admin/admin123)

### 5. –õ–æ–∫–∞–ª—å–Ω—ã–π E2E (–±–µ–∑ Docker, SQLite + Celery eager)

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
make install-dev

# 2. –í–∫–ª—é—á–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ä–µ–∂–∏–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á (–±–µ–∑ Redis)
set CELERY_TASK_ALWAYS_EAGER=1  # PowerShell/Windows
# export CELERY_TASK_ALWAYS_EAGER=1  # bash/Linux/macOS

# 3. –í—ã–ø–æ–ª–Ω–∏—Ç—å —à–∞–≥–∏ –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏
make process-raw    # –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—ã—Ä—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ -> –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
make anomalies      # –∑–∞–ø—É—Å–∫ –¥–µ—Ç–µ–∫—Ü–∏–∏ –∞–Ω–æ–º–∞–ª–∏–π
make forecast       # –ø—Ä–æ–≥–Ω–æ–∑ —Ç—Ä–µ–Ω–¥–æ–≤
make report         # —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á—ë—Ç –≤ –∫–æ–Ω—Å–æ–ª–∏

# –ò–ª–∏ –ø–æ–ª–Ω—ã–π –∫–æ–Ω–≤–µ–π–µ—Ä –æ–¥–Ω–∏–º —à–∞–≥–æ–º
make pipeline
```

### 6. –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ —Å PostgreSQL (—Ä—É—á–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–∑ Alembic)

```bash
make install-dev
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ DATABASE_URL (.env)
make init-db          # —Å–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—ã (Base.metadata.create_all)
set CELERY_TASK_ALWAYS_EAGER=1  # –∏–ª–∏ export ...
python scripts/e2e_pipeline.py --csv ./data/raw --pattern "*.csv" --train-full
make report-html      # HTML –æ—Ç—á—ë—Ç -> reports/latest_report.html
```

–ï—Å–ª–∏ –≤ CSV —Ç–æ–ª—å–∫–æ —Ç—Ä–∏ –∫–æ–ª–æ–Ω–∫–∏ —Ç–æ–∫–æ–≤ (current_R,current_S,current_T) ‚Äî —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞.

–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `CELERY_TASK_ALWAYS_EAGER=1` –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å Celery-–∑–∞–¥–∞—á–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
–≤ —Ç–µ–∫—É—â–µ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ª–æ–∫–∞–ª—å–Ω–æ–π –æ—Ç–ª–∞–¥–∫–∏ –±–µ–∑ –∑–∞–ø—É—Å–∫–∞ –±—Ä–æ–∫–µ—Ä–∞ Redis.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```bash
# –ó–∞–≥—Ä—É–∑–∫–∞ CSV —Ñ–∞–π–ª–æ–≤
make load-csv

# –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
make extract-features

# –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
make train-models

### –ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö CSV —á–µ—Ä–µ–∑ Docker

–î–ª—è —É–¥–æ–±–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–∫–∞–ª—å–Ω—ã—Ö CSV-—Ñ–∞–π–ª–æ–≤ –∏–∑ –≤–∞—à–µ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –≤ –ë–î –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–µ—Ä–≤–∏—Å `loader` –∏–∑ `docker-compose.dev.yml`.

1) –ü–æ–¥–Ω–∏–º–∏—Ç–µ Postgres –∏ Redis:

```bash
docker compose -f docker-compose.dev.yml up -d postgres redis
```

2) –ó–∞–≥—Ä—É–∑–∫–∞ –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞:

```bash
docker compose -f docker-compose.dev.yml run --rm loader \
     python src/data_processing/csv_loader.py /data/csvs/sample.csv --sample-rate 25600
```

3) –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:

```bash
docker compose -f docker-compose.dev.yml run --rm loader \
     python src/data_processing/csv_loader.py /data/csvs --sample-rate 25600 --batch-size 10000
```

–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:
- –í `docker-compose.dev.yml` —Å–µ—Ä–≤–∏—Å `loader` –º–æ–Ω—Ç–∏—Ä—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å CSV –≤ `/data/csvs` –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–ø—É—Ç—å —Å–ª–µ–≤–∞ –≤ volume –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ø—É—Ç—å –∫ –≤–∞—à–µ–π –ø–∞–ø–∫–µ CSV).
- `DATABASE_URL` –∏ `REDIS_URL` –±–µ—Ä—É—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ dev-–∫–æ–º–ø–æ—É–∑; —Å–µ—Ä–≤–∏—Å –ø–∏—à–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –≤ Postgres –∏–∑ —Å–æ—Å—Ç–∞–≤–∞ `docker-compose.dev.yml`.
```

### API –ø—Ä–∏–º–µ—Ä—ã

```python
import requests

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –¥–≤–∏–≥–∞—Ç–µ–ª—è
response = requests.get("http://localhost:8000/api/v1/motor/status/motor_001")

# –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π
response = requests.post("http://localhost:8000/api/v1/detect/anomaly", 
                        json={"motor_id": "motor_001"})

# –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ
response = requests.post("http://localhost:8000/api/v1/predict/degradation",
                        json={"motor_id": "motor_001", "horizon_days": 30})
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
DiagMod/
‚îú‚îÄ‚îÄ src/                    # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ api/               # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ dashboard/         # Streamlit –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å  
‚îÇ   ‚îú‚îÄ‚îÄ worker/            # Celery –∑–∞–¥–∞—á–∏
‚îÇ   ‚îú‚îÄ‚îÄ ml/                # ML –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ data_processing/   # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ database/          # –ú–æ–¥–µ–ª–∏ –ë–î
‚îú‚îÄ‚îÄ data/                  # –î–∞–Ω–Ω—ã–µ (—Å—ã—Ä—ã–µ, –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ)
‚îú‚îÄ‚îÄ models/                # –û–±—É—á–µ–Ω–Ω—ã–µ ML –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ sql/                   # SQL —Å—Ö–µ–º—ã –∏ —Å–∫—Ä–∏–ø—Ç—ã
‚îú‚îÄ‚îÄ docker/                # Docker —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ configs/               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ tests/                 # –¢–µ—Å—Ç—ã
```

## –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

CSV —Ñ–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —Ñ–æ—Ä–º–∞—Ç:

```csv
current_R,current_S,current_T
1.23,1.45,1.67
1.24,,1.68
1.25,1.47,
...
```

- –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞: –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ñ–∞–∑
- –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏: –∑–Ω–∞—á–µ–Ω–∏—è —Ç–æ–∫–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
- –ü—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è –¥–ª—è —Ñ–∞–∑ S –∏ T

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
make install-dev  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å dev –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
```

### –õ–æ–∫–∞–ª—å–Ω—ã–π Postgres (–±–µ–∑ Docker)

- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î.
- –§–æ—Ä–º–∞—Ç —Å—Ç—Ä–æ–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:

```
postgresql+asyncpg://diagmod_user:diagmod@localhost:5432/diagmod
```

–í Windows PowerShell –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞ —Ç–µ–∫—É—â—É—é —Å–µ—Å—Å–∏—é —Ç–∞–∫:

```
$env:DATABASE_URL = "postgresql+asyncpg://diagmod_user:diagmod@localhost:5432/diagmod"
$env:APP_ENVIRONMENT = "development"
```

## –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –±–µ–∑ Docker

–°–º. –ø–æ–¥—Ä–æ–±–Ω—ã–π –≥–∞–π–¥: LOCAL_RUN.md ‚Äî –∫–∞–∫ –ø–æ–¥–Ω—è—Ç—å API, –ë–î (SQLite/PostgreSQL) –∏ Celery –≤ venv –Ω–∞ Windows.

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
make test          # –í—Å–µ —Ç–µ—Å—Ç—ã
make test-unit     # –¢–æ–ª—å–∫–æ unit —Ç–µ—Å—Ç—ã
make test-coverage # –¢–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
```

### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞

```bash
make format       # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
make lint         # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–Ω—Ç–µ—Ä–∞–º–∏
```

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –≤ —Ä–µ–∂–∏–º–µ hot-reload

```bash
make up-dev  # –ó–∞–ø—É—Å–∫ —Å –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π
```

## ML –ú–æ–¥–µ–ª–∏

### –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π
- **Isolation Forest**: –î–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –≤—ã–±—Ä–æ—Å–æ–≤
- **One-Class SVM**: –î–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –Ω–æ–≤–∏–∑–Ω—ã
- **Autoencoder**: –î–ª—è —Å–ª–æ–∂–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

### –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ
- **XGBoost**: –î–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –ø—Ä–æ–≥–Ω–æ–∑–æ–≤
- **Prophet**: –î–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤
- **LSTM**: –î–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Ç—Ä–µ–Ω–¥–æ–≤
 - **TCN (Temporal Convolutional Network)**: –ü—Ä–æ–≥–Ω–æ–∑ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –¥–µ—Ñ–µ–∫—Ç–∞ –∏ —Å—Ç–µ–ø–µ–Ω–∏ –µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è –Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–µ H.

### Sequence / TCN –û–±—É—á–µ–Ω–∏–µ

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è TCN (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –∏ –∞–≥—Ä–µ–≥–∞—Ç—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤):

```bash
python -c "import asyncio,uuid; from src.ml.tcn_forecasting import train_tcn; from src.config.settings import get_settings; eid='00000000-0000-0000-0000-000000000000'; asyncio.run(train_tcn(uuid.UUID(eid)))"
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ `.env`:

```
TCN_WINDOW_SIZE=32
TCN_PREDICTION_HORIZON=4
TCN_CHANNELS=64,64,64
TCN_KERNEL_SIZE=3
TCN_DROPOUT=0.1
TCN_MAX_EPOCHS=10
TCN_LEARNING_RATE=0.001
```

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `models/tcn/model_<equipment_id>.pkl`.

### –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

–í–∫–ª—é—á–µ–Ω–æ —á–µ—Ä–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫—É `USE_MODEL_CACHE=true`.

–ö–µ—à–∏—Ä—É—é—Ç—Å—è:
 - Prophet –º–æ–¥–µ–ª—å –¥–ª—è RMS (`models/prophet_rms/<equipment_id>.pkl`)
 - LSTM sequence (`models/lstm_seq/<equipment_id>.pkl`)
 - TCN (`models/tcn/model_<equipment_id>.pkl`)

–ú–µ—Ç—Ä–∏–∫–∞ `model_cache_events_total{model_name, event}` –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è:
 - `hit` ‚Äî –º–æ–¥–µ–ª—å –Ω–∞–π–¥–µ–Ω–∞ –≤ –ø–∞–º—è—Ç–∏ / –Ω–∞ –¥–∏—Å–∫–µ
 - `miss` ‚Äî –º–æ–¥–µ–ª—å –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –∏ –±—ã–ª–∞ –æ–±—É—á–µ–Ω–∞ –∑–∞–Ω–æ–≤–æ
 - `store` ‚Äî —É—Å–ø–µ—à–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –≤ –∫–µ—à

–ü—Ä–∏–º–µ—Ä –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –º–µ—Ç—Ä–∏–∫–∏:
```
curl http://localhost:8001/metrics | findstr model_cache_events_total
```

### –ü—Ä–∏–∑–Ω–∞–∫–∏
- **–í—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—Å—Ç—å**: RMS, —Å—Ä–µ–¥–Ω–µ–µ, –¥–∏—Å–ø–µ—Ä—Å–∏—è, kurtosis, skewness
- **–ß–∞—Å—Ç–æ—Ç–Ω–∞—è –æ–±–ª–∞—Å—Ç—å**: FFT –ø–∏–∫–∏, —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–∞—è —ç–Ω—Ç—Ä–æ–ø–∏—è, MFCC
- **–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ**: –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã, –∫–≤–∞–Ω—Ç–∏–ª–∏, –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ú–µ—Ç—Ä–∏–∫–∏
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã (CPU, –ø–∞–º—è—Ç—å, –¥–∏—Å–∫)
- –ö–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π ML (—Ç–æ—á–Ω–æ—Å—Ç—å, –ø–æ–ª–Ω–æ—Ç–∞, F1-score)
- –ë–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤, –∞–Ω–æ–º–∞–ª–∏–π)

### –ú–µ—Ç—Ä–∏–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö / –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
–î–æ–±–∞–≤–ª–µ–Ω—ã Prometheus –º–µ—Ç—Ä–∏–∫–∏:
- `features_with_embedding_total` ‚Äì –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ Feature —Å embedding
- `embedding_coverage_ratio` ‚Äì –¥–æ–ª—è features —Å embedding
- `clustering_noise_ratio` ‚Äì –¥–æ–ª—è —Ç–æ—á–µ–∫ –±–µ–∑ cluster_id
- `clustering_label_coverage_ratio` ‚Äì –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –º–µ—Ç–∫–∞–º–∏ –¥–µ—Ñ–µ–∫—Ç–æ–≤
- `min_cluster_size_labeled`, `p50_cluster_size`, `p90_cluster_size` ‚Äì —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- `data_recency_seconds` ‚Äì –¥–∞–≤–Ω–æ—Å—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- `clustering_drift_score` ‚Äì –æ—Ü–µ–Ω–∫–∞ –¥—Ä–µ–π—Ñ–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (JS divergence 0..1)
- `training_snapshot_timestamp` ‚Äì –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ snapshot –¥–∞—Ç–∞—Å–µ—Ç–∞

### Data Readiness & Snapshot Endpoints
- `GET /admin/clustering/data-readiness` ‚Äì –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
- `GET /admin/clustering/summary` ‚Äì –¥–∏—Å—Ç—Ä–∏–±—É—Ü–∏—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ + manifest + label coverage
- `POST /admin/clustering/snapshot` ‚Äì —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ parquet snapshot (embeddings+labels)
- `GET /admin/clustering/embedding-manifest` ‚Äì manifest embedding –∞–≤—Ç–æ—ç–Ω–∫–æ–¥–µ—Ä–∞ (–∫–æ–¥ hash, dim, –≤–µ—Ä—Å–∏—è)

### –ú–∞–Ω–∏—Ñ–µ—Å—Ç—ã –º–æ–¥–µ–ª–µ–π
–•—Ä–∞–Ω—è—Ç—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `models/`:
- `models/anomaly_detection/latest/manifest.json` ‚Äì streaming anomaly –º–æ–¥–µ–ª—å (threshold, p98, outlier_ratio, version)
- `models/clustering/manifest.json` ‚Äì —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ (clusters_found, labeled, params)
- `models/embeddings/manifest.json` ‚Äì –∞–≤—Ç–æ—ç–Ω–∫–æ–¥–µ—Ä —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ (embedding_dim, code_hash, trained_at, version, final_loss)
- `models/clustering/knn_manifest.json` ‚Äì semi-supervised kNN —Å–æ—Å—Ç–æ—è–Ω–∏–µ (coverage)
- `models/snapshots/<ts>/manifest.json` ‚Äì snapshot –æ–±—É—á–∞—é—â–µ–≥–æ –Ω–∞–±–æ—Ä–∞

### –ê–ª–µ—Ä—Ç—ã
- –ü–∞–¥–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏
- –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–∏—Å—Ç–µ–º—É
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–Ω–æ–º–∞–ª–∏–∏ –≤ –¥–≤–∏–≥–∞—Ç–µ–ª—è—Ö

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è API –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- RBAC –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- Rate limiting –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç DoS
- HTTPS –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã
- **CPU**: 8+ —è–¥–µ—Ä –¥–ª—è ML –æ–±—É—á–µ–Ω–∏—è
- **RAM**: 16+ GB –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö CSV
- **–î–∏—Å–∫**: SSD –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
- **GPU**: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- –ò–Ω–¥–µ–∫—Å—ã PostgreSQL –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- Redis –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —á–∞—Å—Ç—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ë–∞—Ç—á–µ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ CSV —Ñ–∞–π–ª–æ–≤
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –¥–ª—è —Ç—è–∂–µ–ª—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
 - –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü `raw_signals` –∏ `features` –ø–æ –º–µ—Å—è—Ü–∞–º (`sql/schema/005_partitioning.sql`)
 - –ü–æ—á–∞—Å–æ–≤—ã–µ –∞–≥—Ä–µ–≥–∞—Ç—ã RMS (`hourly_feature_summary`) + Feature Store (db/redis)
 - –ü—Ä–æ—Ä–µ–∂–∏–≤–∞–Ω–∏–µ –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π (—á–∞—Å–æ–≤–æ–π —Ç—Ä–µ–Ω–¥)
 - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ sequence risk (Redis / DB fallback)

## Dashboard: –¢—Ä–µ–Ω–¥—ã, –†–∏—Å–∫ –∏ Feature Store

–î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∫–ª–∞–¥–∫–∞ **"–¢—Ä–µ–Ω–¥—ã"**:
 - –ü–æ—á–∞—Å–æ–≤–æ–π –≥—Ä–∞—Ñ–∏–∫ —Å—Ä–µ–¥–Ω–µ–≥–æ RMS (–∞–≥—Ä–µ–≥–∞—Ç—ã –∏–∑ HourlyFeatureSummary –∏–ª–∏ Redis Feature Store)
 - –ö–Ω–æ–ø–∫–∞ —Ä–∞—Å—á—ë—Ç–∞ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ä–∏—Å–∫–∞ (sequence LSTM) —á–µ—Ä–µ–∑ —ç–Ω–¥–ø–æ–∏–Ω—Ç `GET /api/v1/signals/sequence_risk/{equipment_id}`
 - –≠–Ω–¥–ø–æ–∏–Ω—Ç —Ç—Ä–µ–Ω–¥–∞: `GET /api/v1/equipment/{equipment_id}/rms/hourly?limit=168`

Feature Store (`src/utils/feature_store.py`):
 - Backend `db`: —á—Ç–µ–Ω–∏–µ –∏–∑ –ë–î –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è
 - Backend `redis`: —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö N —Ç–æ—á–µ–∫ –≤ Redis —Å–ø–∏—Å–∫–µ
 - –ê–≤—Ç–æ-–∑–∞–ø–∏—Å—å RMS –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
 - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è: FEATURE_STORE_BACKEND (db|redis), MAX_FEATURE_STORE_POINTS (–ª–∏–º–∏—Ç —Ç–æ—á–µ–∫ –¥–ª—è redis)
 - –ú–µ—Ç—Ä–∏–∫–∏: feature_store_hit_total{backend}, feature_store_miss_total{backend,reason}

–ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:
 - –°–∫—Ä–∏–ø—Ç `sql/schema/005_partitioning.sql` –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Ç–∞–±–ª–∏—Ü—ã –≤ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏ —Å–æ–∑–¥–∞—ë—Ç –º–µ—Å—è—á–Ω—ã–µ –ø–∞—Ä—Ç–∏—Ü–∏–∏ ¬±12 –º–µ—Å—è—Ü–µ–≤
 - –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ: `psql "$DATABASE_URL" -f sql/schema/005_partitioning.sql`


## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Development
```bash
make up-dev
```

### Staging
```bash
make deploy-staging
```

### Production
```bash
make deploy-prod
```

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](docs/api/README.md)
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é](docs/deployment/README.md)
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è](docs/user_guide/README.md)

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `make logs`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: `make status`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–¥–æ—Ä–æ–≤—å–µ: `make health`


## –ö–æ–º–∞–Ω–¥–∞

–¶–∏—Ñ—Ä–æ–≤–æ–π –°–∏–Ω—Ç–µ–∑
