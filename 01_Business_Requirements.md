# Диагностическая система асинхронных двигателей — Бизнес‑требования (BRD)

Версия: 1.0 • Статус: утверждено • Дата: 2025‑08‑25 • Владелец: Product Owner

## Оглавление

- Введение
- Стейкхолдеры и персоны
- Проблема и цели
- Область (in/out), предположения, зависимости
- Потоки ценности и процессы
- Бизнес‑требования (приоритеты)
- KPI и измерение ценности
- Ограничения, риски и меры
- Дорожная карта релиза 1.2
- Глоссарий и изменения

## Введение
Система помогает выявлять отклонения в работе асинхронных электродвигателей по токовым сигналам для снижения простоев и затрат. Состав: прием CSV/API, обработка сигналов, извлечение признаков, детекция аномалий, прогноз трендов, веб‑API и дашборд.

## Стейкхолдеры и персоны
- Product Owner — отвечает за KPI и ROI.
- Главный механик — принимает решения о ТО; «инженер» в дашборде.
- Оператор — загружает/контролирует данные, следит за статусами.
- Data Scientist — дообучает модели, анализирует результаты.
- DevOps/ИТ — эксплуатация, мониторинг, резервирование.

## Проблема и цели
- Проблема: позднее обнаружение деградации приводит к простоям и дорогому ремонту.
- Цели:
	- Раннее предупреждение о рисках отказа.
	- Прозрачность состояния парка оборудования (дашборд, отчеты, API).
	- Снижение TCO за счёт прогнозного обслуживания.

## Область (in scope)
- Массовая загрузка CSV (фазы R/S/T), дедупликация по `file_hash`.
- Хранение RawSignal/Feature/AnomalyScore/Forecast в PostgreSQL.
- Конвейер: валидация → признаки → аномалии → прогноз; статусы обработки.
- Веб‑API (FastAPI) и дашборд (Streamlit), метрики (Prometheus).

Out of scope (релиз 1.2): ERP/CMMS интеграции, мобильные клиенты, SLA 24×7.

Предположения: локальный PostgreSQL, запуск без Docker допустим, ОС Windows/Ubuntu, Python 3.11+.

Зависимости: Alembic миграции, pydantic‑settings, SQLAlchemy asyncio.

## Потоки ценности и процессы
Высокоуровневый процесс:
1) Оператор загружает CSV → система валидирует и сохраняет RawSignal.
2) Планировщик/скрипт обрабатывает N сигналов → признаки/аномалии/прогноз → статусы.
3) Инженер анализирует дашборд/отчёты и принимает решения о ТО.
4) ДС‑специалист при необходимости переобучает модели и публикует «latest».

Схема (упрощенно):

```
CSV → Валидация → Хранилище (RawSignal) → Признаки → Аномалии → Прогноз → Дашборд/API
```

## Бизнес‑требования (приоритеты)
- BT‑1 (Must). Дедупликация по `file_hash` для батч‑вставок.
- BT‑2 (Must). Обработка файла до ~1.5 млн значений/фаза без падений.
- BT‑3 (Must). Идемпотентность обработки и устойчивость к перезапускам.
- BT‑4 (Should). Параллельная обработка на нескольких машинах/процессах.
- BT‑5 (Should). Время от загрузки до признаков ≤ 10 минут на референс‑сервере.
- BT‑6 (Should). Доступность API/дашборда ≥ 99% в рабочее время (9×5, локально).
- BT‑7 (Could). Экспорт отчётов и выгрузок данных для офлайн‑анализа.

## KPI и измерение ценности
- Снижение внеплановых простоев на X% за 6–12 мес (метод: анализ инцидентов).
- Precision/Recall детекции аномалий ≥ целевых порогов (по пилотному датасету).
- Обработка 1000 сигналов ≤ целевого SLA (ориентир ≤ 30 мин) — измерение на стенде.
- Сокращение времени анализа инженером на Y% (опрос/тайм‑лог).

## Ограничения и риски
- Ограничения: локальный запуск без Redis в dev; без GPU; конфигурация через .env.
- Риски: низкое качество данных (валидация и обратная связь); ложные срабатывания (калибровка/дообучение); производительность (батчи/индексы/пулы БД).

## Дорожная карта (релиз 1.2)
- R1. CSV ingestion с дедупликацией; базовые признаки; дашборд; API /health, /metrics.
- R2. Параллельная обработка и идемпотентность; отчётность; прогноз по базовым моделям.
- R3. Тюнинг производительности и стабильности; подготовка к интеграциям.

## Глоссарий
RawSignal — запись «сырого» сигнала; Feature — признаки; AnomalyScore — оценка аномальности; Forecast — прогноз тренда; Equipment — объект диагностики.

## Журнал изменений
- 2025‑08‑25: начальная версия BRD для релиза 1.2.
